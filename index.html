<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>DOM MUSIC</title>

<style>
body{
background:#0b132b;
font-family:Arial;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
color:white;
}

.container{
width:400px;
background:#1c2541;
padding:30px;
border-radius:10px;
}

input,select{
width:100%;
padding:12px;
margin-top:10px;
border:none;
border-radius:6px;
}

button{
width:100%;
padding:12px;
margin-top:15px;
background:orange;
border:none;
color:white;
font-size:16px;
border-radius:6px;
cursor:pointer;
}
</style>
</head>

<body>

<div class="container">

<h2>DOM MUSIC ðŸŽµ</h2>

<select id="tipo">
<option value="aluno">Aluno</option>
<option value="professor">Professor</option>
</select>

<input type="email" id="email" placeholder="Email">
<input type="password" id="senha" placeholder="Senha">

<button onclick="criarConta()">Criar Conta</button>
<button onclick="login()">Entrar</button>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";

import {
getAuth,
createUserWithEmailAndPassword,
signInWithEmailAndPassword
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

import {
getFirestore,
doc,
setDoc,
getDoc
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig={
apiKey:"AIzaSyBp4HTngTmzi3Kh2ejMSURnU8ctJoTJ1ms",
authDomain:"dom-music-127a8.firebaseapp.com",
projectId:"dom-music-127a8",
storageBucket:"dom-music-127a8.appspot.com",
messagingSenderId:"412932629110",
appId:"1:412932629110:web:f6122e06eb77179a3f3557"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

window.criarConta=async function(){

const email=email.value;
const senha=senha.value;
const tipo=tipo.value;

const user=await createUserWithEmailAndPassword(auth,email,senha);

await setDoc(doc(db,"usuarios",user.user.uid),{
tipo:tipo,
email:email
});

alert("Conta criada!");

if(tipo==="professor"){
window.location.href="painel-prof.html";
}else{
window.location.href="painel.html";
}
}

window.login=async function(){

const email=document.getElementById("email").value;
const senha=document.getElementById("senha").value;

const cred=await signInWithEmailAndPassword(auth,email,senha);

const docRef=doc(db,"usuarios",cred.user.uid);
const snap=await getDoc(docRef);

const tipo=snap.data().tipo;

if(tipo==="professor"){
window.location.href="painel-prof.html";
}else{
window.location.href="painel.html";
}

}

</script>

</body>
</html>
